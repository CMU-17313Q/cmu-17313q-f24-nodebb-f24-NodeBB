'use strict';function cov_1zr92lsgpt(){var path="/home/jdufitum/nodebb-f24-pentagon/src/middleware/csrf.js";var hash="5d38150dde6eea2060208602efe7aa9deb01633c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/jdufitum/nodebb-f24-pentagon/src/middleware/csrf.js",statementMap:{"0":{start:{line:3,column:21},end:{line:3,column:41}},"1":{start:{line:9,column:4},end:{line:22,column:2}},"2":{start:{line:11,column:2},end:{line:19,column:3}},"3":{start:{line:12,column:3},end:{line:12,column:38}},"4":{start:{line:13,column:9},end:{line:19,column:3}},"5":{start:{line:14,column:3},end:{line:14,column:30}},"6":{start:{line:15,column:9},end:{line:19,column:3}},"7":{start:{line:16,column:3},end:{line:16,column:25}},"8":{start:{line:17,column:9},end:{line:19,column:3}},"9":{start:{line:18,column:3},end:{line:18,column:26}},"10":{start:{line:24,column:0},end:{line:28,column:2}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:10,column:22},end:{line:10,column:23}},loc:{start:{line:10,column:31},end:{line:20,column:2}},line:10}},branchMap:{"0":{loc:{start:{line:11,column:2},end:{line:19,column:3}},type:"if",locations:[{start:{line:11,column:2},end:{line:19,column:3}},{start:{line:11,column:2},end:{line:19,column:3}}],line:11},"1":{loc:{start:{line:13,column:9},end:{line:19,column:3}},type:"if",locations:[{start:{line:13,column:9},end:{line:19,column:3}},{start:{line:13,column:9},end:{line:19,column:3}}],line:13},"2":{loc:{start:{line:13,column:13},end:{line:13,column:44}},type:"binary-expr",locations:[{start:{line:13,column:13},end:{line:13,column:21}},{start:{line:13,column:25},end:{line:13,column:44}}],line:13},"3":{loc:{start:{line:15,column:9},end:{line:19,column:3}},type:"if",locations:[{start:{line:15,column:9},end:{line:19,column:3}},{start:{line:15,column:9},end:{line:19,column:3}}],line:15},"4":{loc:{start:{line:15,column:13},end:{line:15,column:39}},type:"binary-expr",locations:[{start:{line:15,column:13},end:{line:15,column:21}},{start:{line:15,column:25},end:{line:15,column:39}}],line:15},"5":{loc:{start:{line:17,column:9},end:{line:19,column:3}},type:"if",locations:[{start:{line:17,column:9},end:{line:19,column:3}},{start:{line:17,column:9},end:{line:19,column:3}}],line:17},"6":{loc:{start:{line:17,column:13},end:{line:17,column:41}},type:"binary-expr",locations:[{start:{line:17,column:13},end:{line:17,column:22}},{start:{line:17,column:26},end:{line:17,column:41}}],line:17}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},f:{"0":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5d38150dde6eea2060208602efe7aa9deb01633c"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1zr92lsgpt=function(){return actualCoverage;};}return actualCoverage;}cov_1zr92lsgpt();const{csrfSync}=(cov_1zr92lsgpt().s[0]++,require('csrf-sync'));const{generateToken,csrfSynchronisedProtection,isRequestValid}=(cov_1zr92lsgpt().s[1]++,csrfSync({getTokenFromRequest:req=>{cov_1zr92lsgpt().f[0]++;cov_1zr92lsgpt().s[2]++;if(req.headers['x-csrf-token']){cov_1zr92lsgpt().b[0][0]++;cov_1zr92lsgpt().s[3]++;return req.headers['x-csrf-token'];}else{cov_1zr92lsgpt().b[0][1]++;cov_1zr92lsgpt().s[4]++;if((cov_1zr92lsgpt().b[2][0]++,req.body)&&(cov_1zr92lsgpt().b[2][1]++,req.body.csrf_token)){cov_1zr92lsgpt().b[1][0]++;cov_1zr92lsgpt().s[5]++;return req.body.csrf_token;}else{cov_1zr92lsgpt().b[1][1]++;cov_1zr92lsgpt().s[6]++;if((cov_1zr92lsgpt().b[4][0]++,req.body)&&(cov_1zr92lsgpt().b[4][1]++,req.body._csrf)){cov_1zr92lsgpt().b[3][0]++;cov_1zr92lsgpt().s[7]++;return req.body._csrf;}else{cov_1zr92lsgpt().b[3][1]++;cov_1zr92lsgpt().s[8]++;if((cov_1zr92lsgpt().b[6][0]++,req.query)&&(cov_1zr92lsgpt().b[6][1]++,req.query._csrf)){cov_1zr92lsgpt().b[5][0]++;cov_1zr92lsgpt().s[9]++;return req.query._csrf;}else{cov_1zr92lsgpt().b[5][1]++;}}}}},size:64}));cov_1zr92lsgpt().s[10]++;module.exports={generateToken,csrfSynchronisedProtection,isRequestValid};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMXpyOTJsc2dwdCIsInBhdGgiLCJoYXNoIiwiZ2xvYmFsIiwiRnVuY3Rpb24iLCJnY3YiLCJjb3ZlcmFnZURhdGEiLCJzdGF0ZW1lbnRNYXAiLCJzdGFydCIsImxpbmUiLCJjb2x1bW4iLCJlbmQiLCJmbk1hcCIsIm5hbWUiLCJkZWNsIiwibG9jIiwiYnJhbmNoTWFwIiwidHlwZSIsImxvY2F0aW9ucyIsInMiLCJmIiwiYiIsIl9jb3ZlcmFnZVNjaGVtYSIsImNvdmVyYWdlIiwiYWN0dWFsQ292ZXJhZ2UiLCJjc3JmU3luYyIsInJlcXVpcmUiLCJnZW5lcmF0ZVRva2VuIiwiY3NyZlN5bmNocm9uaXNlZFByb3RlY3Rpb24iLCJpc1JlcXVlc3RWYWxpZCIsImdldFRva2VuRnJvbVJlcXVlc3QiLCJyZXEiLCJoZWFkZXJzIiwiYm9keSIsImNzcmZfdG9rZW4iLCJfY3NyZiIsInF1ZXJ5Iiwic2l6ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJjc3JmLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgeyBjc3JmU3luYyB9ID0gcmVxdWlyZSgnY3NyZi1zeW5jJyk7XG5cbmNvbnN0IHtcblx0Z2VuZXJhdGVUb2tlbixcblx0Y3NyZlN5bmNocm9uaXNlZFByb3RlY3Rpb24sXG5cdGlzUmVxdWVzdFZhbGlkLFxufSA9IGNzcmZTeW5jKHtcblx0Z2V0VG9rZW5Gcm9tUmVxdWVzdDogKHJlcSkgPT4ge1xuXHRcdGlmIChyZXEuaGVhZGVyc1sneC1jc3JmLXRva2VuJ10pIHtcblx0XHRcdHJldHVybiByZXEuaGVhZGVyc1sneC1jc3JmLXRva2VuJ107XG5cdFx0fSBlbHNlIGlmIChyZXEuYm9keSAmJiByZXEuYm9keS5jc3JmX3Rva2VuKSB7XG5cdFx0XHRyZXR1cm4gcmVxLmJvZHkuY3NyZl90b2tlbjtcblx0XHR9IGVsc2UgaWYgKHJlcS5ib2R5ICYmIHJlcS5ib2R5Ll9jc3JmKSB7XG5cdFx0XHRyZXR1cm4gcmVxLmJvZHkuX2NzcmY7XG5cdFx0fSBlbHNlIGlmIChyZXEucXVlcnkgJiYgcmVxLnF1ZXJ5Ll9jc3JmKSB7XG5cdFx0XHRyZXR1cm4gcmVxLnF1ZXJ5Ll9jc3JmO1xuXHRcdH1cblx0fSxcblx0c2l6ZTogNjQsXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG5cdGdlbmVyYXRlVG9rZW4sXG5cdGNzcmZTeW5jaHJvbmlzZWRQcm90ZWN0aW9uLFxuXHRpc1JlcXVlc3RWYWxpZCxcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBLFlBQVksQ0FBQyxTQUFBQSxlQUFBLE1BQUFDLElBQUEsaUVBQUFDLElBQUEsZ0RBQUFDLE1BQUEsS0FBQUMsUUFBQSxzQkFBQUMsR0FBQSxvQkFBQUMsWUFBQSxFQUFBTCxJQUFBLDZEQUFBTSxZQUFBLE9BQUFDLEtBQUEsRUFBQUMsSUFBQSxHQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxHQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxHQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFdBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFVBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLFlBQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE1BQUFFLEtBQUEsT0FBQUMsSUFBQSxpQkFBQUMsSUFBQSxFQUFBTixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxLQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBSyxHQUFBLEVBQUFQLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLEtBQUFELElBQUEsTUFBQU8sU0FBQSxPQUFBRCxHQUFBLEVBQUFQLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLEtBQUFPLElBQUEsTUFBQUMsU0FBQSxHQUFBVixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxJQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBRixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxJQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBRCxJQUFBLFVBQUFNLEdBQUEsRUFBQVAsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsSUFBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsS0FBQU8sSUFBQSxNQUFBQyxTQUFBLEdBQUFWLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE1BQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE1BQUFELElBQUEsVUFBQU0sR0FBQSxFQUFBUCxLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxLQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBTyxJQUFBLGVBQUFDLFNBQUEsR0FBQVYsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsS0FBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsT0FBQUYsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsS0FBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsT0FBQUQsSUFBQSxVQUFBTSxHQUFBLEVBQUFQLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLElBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLEtBQUFPLElBQUEsTUFBQUMsU0FBQSxHQUFBVixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxJQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBRixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxJQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxNQUFBRCxJQUFBLFVBQUFNLEdBQUEsRUFBQVAsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsS0FBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsTUFBQU8sSUFBQSxlQUFBQyxTQUFBLEdBQUFWLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE9BQUFGLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE9BQUFELElBQUEsVUFBQU0sR0FBQSxFQUFBUCxLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxJQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxLQUFBTyxJQUFBLE1BQUFDLFNBQUEsR0FBQVYsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsSUFBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsTUFBQUYsS0FBQSxFQUFBQyxJQUFBLElBQUFDLE1BQUEsSUFBQUMsR0FBQSxFQUFBRixJQUFBLElBQUFDLE1BQUEsTUFBQUQsSUFBQSxVQUFBTSxHQUFBLEVBQUFQLEtBQUEsRUFBQUMsSUFBQSxJQUFBQyxNQUFBLEtBQUFDLEdBQUEsRUFBQUYsSUFBQSxJQUFBQyxNQUFBLE1BQUFPLElBQUEsZUFBQUMsU0FBQSxHQUFBVixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxLQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxPQUFBRixLQUFBLEVBQUFDLElBQUEsSUFBQUMsTUFBQSxLQUFBQyxHQUFBLEVBQUFGLElBQUEsSUFBQUMsTUFBQSxPQUFBRCxJQUFBLE1BQUFVLENBQUEsc0VBQUFDLENBQUEsU0FBQUMsQ0FBQSx5RUFBQUMsZUFBQSw0Q0FBQXBCLElBQUEsaURBQUFxQixRQUFBLENBQUFwQixNQUFBLENBQUFFLEdBQUEsSUFBQUYsTUFBQSxDQUFBRSxHQUFBLFVBQUFrQixRQUFBLENBQUF0QixJQUFBLEdBQUFzQixRQUFBLENBQUF0QixJQUFBLEVBQUFDLElBQUEsR0FBQUEsSUFBQSxFQUFBcUIsUUFBQSxDQUFBdEIsSUFBQSxFQUFBSyxZQUFBLE1BQUFrQixjQUFBLENBQUFELFFBQUEsQ0FBQXRCLElBQUEsR0FlRDtBQUFBRCxjQUFBLFNBQUFBLENBQUEsU0FBQXdCLGNBQUEsV0FBQUEsY0FBQSxFQUFBeEIsY0FBQSxHQWJaLEtBQU0sQ0FBRXlCLFFBQVMsQ0FBQyxFQUFBekIsY0FBQSxHQUFBbUIsQ0FBQSxNQUFHTyxPQUFPLENBQUMsV0FBVyxDQUFDLEVBRXpDLEtBQU0sQ0FDTEMsYUFBYSxDQUNiQywwQkFBMEIsQ0FDMUJDLGNBQ0QsQ0FBQyxFQUFBN0IsY0FBQSxHQUFBbUIsQ0FBQSxNQUFHTSxRQUFRLENBQUMsQ0FDWkssbUJBQW1CLENBQUdDLEdBQUcsRUFBSyxDQUFBL0IsY0FBQSxHQUFBb0IsQ0FBQSxNQUFBcEIsY0FBQSxHQUFBbUIsQ0FBQSxNQUM3QixHQUFJWSxHQUFHLENBQUNDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBRSxDQUFBaEMsY0FBQSxHQUFBcUIsQ0FBQSxTQUFBckIsY0FBQSxHQUFBbUIsQ0FBQSxNQUNoQyxNQUFPLENBQUFZLEdBQUcsQ0FBQ0MsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUNuQyxDQUFDLElBQU0sQ0FBQWhDLGNBQUEsR0FBQXFCLENBQUEsU0FBQXJCLGNBQUEsR0FBQW1CLENBQUEsU0FBSSxDQUFBbkIsY0FBQSxHQUFBcUIsQ0FBQSxTQUFBVSxHQUFHLENBQUNFLElBQUksSUFBQWpDLGNBQUEsR0FBQXFCLENBQUEsU0FBSVUsR0FBRyxDQUFDRSxJQUFJLENBQUNDLFVBQVUsRUFBRSxDQUFBbEMsY0FBQSxHQUFBcUIsQ0FBQSxTQUFBckIsY0FBQSxHQUFBbUIsQ0FBQSxNQUMzQyxNQUFPLENBQUFZLEdBQUcsQ0FBQ0UsSUFBSSxDQUFDQyxVQUFVLENBQzNCLENBQUMsSUFBTSxDQUFBbEMsY0FBQSxHQUFBcUIsQ0FBQSxTQUFBckIsY0FBQSxHQUFBbUIsQ0FBQSxTQUFJLENBQUFuQixjQUFBLEdBQUFxQixDQUFBLFNBQUFVLEdBQUcsQ0FBQ0UsSUFBSSxJQUFBakMsY0FBQSxHQUFBcUIsQ0FBQSxTQUFJVSxHQUFHLENBQUNFLElBQUksQ0FBQ0UsS0FBSyxFQUFFLENBQUFuQyxjQUFBLEdBQUFxQixDQUFBLFNBQUFyQixjQUFBLEdBQUFtQixDQUFBLE1BQ3RDLE1BQU8sQ0FBQVksR0FBRyxDQUFDRSxJQUFJLENBQUNFLEtBQUssQ0FDdEIsQ0FBQyxJQUFNLENBQUFuQyxjQUFBLEdBQUFxQixDQUFBLFNBQUFyQixjQUFBLEdBQUFtQixDQUFBLFNBQUksQ0FBQW5CLGNBQUEsR0FBQXFCLENBQUEsU0FBQVUsR0FBRyxDQUFDSyxLQUFLLElBQUFwQyxjQUFBLEdBQUFxQixDQUFBLFNBQUlVLEdBQUcsQ0FBQ0ssS0FBSyxDQUFDRCxLQUFLLEVBQUUsQ0FBQW5DLGNBQUEsR0FBQXFCLENBQUEsU0FBQXJCLGNBQUEsR0FBQW1CLENBQUEsTUFDeEMsTUFBTyxDQUFBWSxHQUFHLENBQUNLLEtBQUssQ0FBQ0QsS0FBSyxDQUN2QixDQUFDLEtBQUFuQyxjQUFBLEdBQUFxQixDQUFBLFVBQUQsR0FDRCxDQUFDLENBQ0RnQixJQUFJLENBQUUsRUFDUCxDQUFDLENBQUMsRUFBQ3JDLGNBQUEsR0FBQW1CLENBQUEsT0FFSG1CLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHLENBQ2hCWixhQUFhLENBQ2JDLDBCQUEwQixDQUMxQkMsY0FDRCxDQUFDIiwiaWdub3JlTGlzdCI6W119